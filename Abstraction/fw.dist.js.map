{"version":3,"sources":["fw.js"],"names":[],"mappings":"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","file":"fw.dist.js","sourcesContent":["/*  global Application */\n/*  global Sandbox */\n/*  global Sandbox */\n/*  global setInterval */\n/*  global XMLHttpRequest */\n/*  global Template */\n\nclass Application {\n    constructor(applicationTitle, applicationDefinition) {\n      const definition = applicationDefinition;\n\n      class newApplication {\n\n        constructor(sandbox) {\n          this.sandbox = new Sandbox(this);\n          this.modules = [];\n          this.define(definition(sandbox));\n        }\n\n        define(interfaceDefinition) {\n          for (const method in interfaceDefinition) {\n            if (interfaceDefinition[method].bind) {\n              this[method] = interfaceDefinition[method].bind(this);\n            }else {\n              this[method] = interfaceDefinition[method];\n            }\n          }\n        }\n\n        register(module) {\n          module = new module(this.sandbox);\n\n          this.sandbox.on('DOWN', function applicationDownHandler() {\n            if (this.template.element.className.indexOf('down') === -1) {\n              this.template.element.className = `${this.template.element.className} down`;\n            }\n          }.bind(this));\n\n          this.checkTimer = setInterval(function checkTrimer() {\n            let allOk = true;\n\n            this.modules.forEach(function moduleIterator(currentModule) {\n              if (currentModule.hasOwnProperty('alive')) {\n                if (currentModule.alive === false) {\n                  allOk = false;\n                }\n              }\n            });\n\n            if (allOk) {\n              this.template.element.className = this.template.element.className.replace('down', '');\n            }\n          }.bind(this), 1000);\n\n          this.modules.push(module);\n          return module;\n        }\n\n        startAll() {\n          this.modules.forEach(this.startModule.bind(this));\n        }\n\n        startModule(module) {\n          module.load(this.template.element, (currentModule) => {\n            if (currentModule.init) {\n              currentModule.init.bind(currentModule)();\n            }\n          });\n        }\n\n        destroy() {\n          // this.modules.forEach(function(module){\n            // module.unload();\n            // module.destroy;\n          // }.bind(this))\n        }\n\n        load(HTMLElement) {\n          this.element = HTMLElement;\n          if (this.template) {\n            this.processLayout();\n            this.init();\n          }else {\n            this.sandbox.requestLayout(this.templateUrl, function requestLayout(template) {\n              this.template = template;\n              this.processLayout();\n              this.init();\n            }.bind(this));\n          }\n        }\n\n        processLayout() {\n          this.template = new Template(this.element, this.template, this);\n        }\n\n        get(path, callback) {\n          const oReq = new XMLHttpRequest();\n          oReq.addEventListener('load', function layoutRequestCallback() {\n            callback(this.responseText);\n          });\n          oReq.open('GET', path);\n          oReq.send();\n        }\n\n      }\n\n      newApplication.prototype.title = applicationTitle;\n\n      return newApplication;\n\n    }\n  }\n\n/*  global Template */\n\nclass Module {\n  constructor(moduleDefinition) {\n    class newModule {\n      constructor(sandbox) {\n        moduleDefinition = this.definition(sandbox);\n        this.sandbox = sandbox;\n        this.define(moduleDefinition);\n      }\n\n      define(definition) {\n        for (const method in definition) {\n          if (definition[method].bind) {\n            this[method] = definition[method].bind(this);\n          }else {\n            this[method] = definition[method];\n          }\n        }\n      }\n\n      load(HTMLElement, callback) {\n        this.element = HTMLElement;\n        if (this.template) {\n          this.processLayout();\n          callback(this);\n        }else {\n          this.sandbox.requestLayout(this.templateUrl,\n            function templateHandler(template) {\n              this.template = template;\n              this.processLayout();\n              callback(this);\n            }.bind(this));\n        }\n      }\n\n      processLayout() {\n        this.template = new Template(this.element, this.template, this);\n        this.element = this.template.element;\n      }\n\n    }\n\n    newModule.prototype.definition = moduleDefinition;\n\n    return newModule;\n  }\n}\n\nvar multi = {\n  \n}\n\n/*  global setTimeout */\n/*  global Worker */\n/*  global Template */\n/*  global clearInterval */\n/*  global setInterval*/\n\nFunction.prototype.superBind = function superBind(worker) {\n  return function superBindHandler(event) {\n    worker.postMessage({\n      action: 'contextualExecution',\n      data: this.toString(),\n      event: {\n        data: event.data,\n      },\n    });\n  }.bind(this);\n};\n\nclass ThreadModule {\n  constructor(moduleDefinition) {\n    class newModule {\n      constructor(sandbox) {\n        moduleDefinition = this.definition(sandbox);\n        this.sandbox = sandbox;\n        this.worker = new Worker('worker.js');\n        this.alive = true;\n        this.methods = {};\n\n        this.define(moduleDefinition);\n\n        this.worker.addEventListener('message', this.messageHandler.bind(this));\n\n        this.worker.postMessage({\n          action: 'define',\n          data: this.methods,\n        });\n\n        this.check = setInterval(()=> this.ping(), 1000);\n\n        this.itsAlive = setTimeout(function checkAlive() {\n          this.sandbox.notify('DOWN', this);\n        }.bind(this), 2000);\n\n      }\n\n      ping() {\n        this.worker.postMessage({\n          action: 'ping',\n        });\n      }\n\n      define(definition) {\n        for (const method in definition) {\n          if (method !== 'template') {\n            this.methods[method] = definition[method].toString();\n          }\n        }\n        this.template = definition.template;\n      }\n\n      messageHandler(event) {\n        const action = event.data.action;\n        const data = event.data.data;\n        let operation;\n        switch (action) {\n        case 'sandbox:on':\n          const label = data[0];\n          operation = new Function('event', 'return (' + data[1] + ').bind(this)(event)').superBind(this.worker);\n          this.sandbox.on(label, operation);\n          break;\n        case 'sandbox:notify':\n          this.sandbox.notify(data[0], data[1]);\n          break;\n        case 'setRefProp':\n          this.template.refs[data.ref][data.key] = data.value;\n          break;\n        case 'template':\n          const element = this.template.refs[data[0]];\n          operation = new Function('el', 'return (' + data[1] + ')(el)');\n          operation(element);\n          break;\n        case 'pong':\n          clearInterval(this.itsAlive);\n          this.alive = true;\n          this.itsAlive = setTimeout(function checkAlive() {\n            this.alive = false;\n            this.sandbox.notify('DOWN', this);\n          }.bind(this), 1500);\n          break;\n\n        }\n      }\n\n      init() {\n        this.sendRefs();\n        this.worker.postMessage({\n          action: 'execute',\n          data: 'init',\n        });\n      }\n\n      sendRefs() {\n        for(const ref in this.template.refs) {\n          this.worker.postMessage({action: 'registerRef', data: ref});\n        }\n      }\n\n      load(HTMLElement, callback) {\n        this.element = HTMLElement;\n        if (this.template) {\n          this.processLayout();\n          callback(this);\n        }else {\n          this.sandbox.requestLayout(this.templateUrl,\n            function requestLayout(template) {\n              this.template = template;\n              this.processLayout();\n              callback(this);\n            }.bind(this));\n        }\n      }\n\n      processLayout() {\n        this.template = new Template(this.element, this.template, this);\n        this.element = this.template.element;\n      }\n\n    }\n\n    newModule.prototype.definition = moduleDefinition;\n\n    return newModule;\n  }\n}\n\nclass Event {\n  constructor(data) {\n    this.data = data;\n    this.stopped = false;\n  }\n\n  stopPropagation() {\n    this.stopped = true;\n  }\n\n  shouldExecute() {\n    return !this.stopped;\n  }\n}\n\n// class MessageHandler {\n//   constructor(owner, worker) {\n//     this.worker.addEventListener('message',this.messageHandler.bind(this))\n//   }\n//\n// }\n\n/* global document */\n\nclass Template {\n  constructor(container, HTMLString, context) {\n    let element = document.createElement('div');\n    this.container = container;\n    element.innerHTML = HTMLString;\n    element = element.children[0];\n    this.element = element;\n    this.container.appendChild(element);\n    this.context = context;\n\n    [].forEach.call(this.container.querySelectorAll('[ref]'), this.attachReference.bind(this));\n\n    [].forEach.call(\n      this.container.querySelectorAll('[click]'),\n      function clickEventIterator(currentElement) {\n        this.attachEvent('click', currentElement);\n      }.bind(this));\n\n    [].forEach.call(this.container.querySelectorAll('[template]'), this.attachTemplate.bind(this));\n    this.container = element;\n  }\n  attachReference(element) {\n    if (!this.refs) {\n      this.refs = {};\n    }\n    this.refs[element.getAttribute('ref')] = element;\n  }\n\n  attachTemplate(element) {\n    if (!this.templates) {\n      this.templates = {};\n    }\n    this.templates[element.getAttribute('template')] = element.outerHTML;\n  }\n\n  attachEvent(event, element) {\n    const regex = new RegExp('([^(]+)\\s?(\\([\\S\\s]*\\)?)', 'gmi');\n    const expression = element.getAttribute(event).match(regex);\n    const method = expression[0];\n    let args = expression[1].split('');\n\n    args.pop();\n    args = args.join('').split(',');\n    args = args.map(this.format);\n\n    element.addEventListener('click', function internalClickHandler(evt) {\n      const indexOfEvent = args.indexOf('$event');\n      if (indexOfEvent !== -1) {\n        args[indexOfEvent] = evt;\n      }\n      this.context[method].apply(this, args);\n    }.bind(this));\n\n  }\n\n  format(arg) {\n    if (arg === '$event' || arg === '$e' || arg === '$evt') {\n      return '$event';\n    }\n    if (isNaN(parseInt(arg, 10))) {\n      try {\n        return eval(arg);\n      }catch(e) {\n        return arg.toString();\n      }\n    }\n    return parseInt(arg, 10);\n  }\n\n}\n\n/*  global Event */\nclass Sandbox {\n  constructor(core) {\n    if (!core) {\n      core = {};\n    }\n    this.events = {};\n    this.core = core;\n  }\n\n  requestLayout(url, callback) {\n    this.core.get(url, callback);\n  }\n\n  on(label, action) {\n    if (!this.events[label]) {\n      this.events[label] = [];\n    }\n    this.events[label].push(action);\n  }\n\n  notify(label, data) {\n    const event = new Event(data);\n    if (this.events[label]) {\n      this.events[label].forEach((action)=>{\n        if (event.shouldExecute()) {\n          action(event);\n        }\n      });\n    }\n  }\n}\n\n/* global document */\n/* global Sandbox */\n\nclass Platform {\n\n  constructor(rootElement) {\n    this.element = document.querySelector('.applications');\n    this.sandbox = new Sandbox(this);\n    this.publicSandbox = new Sandbox(this);\n    this.applications = [];\n    this.instances = [];\n    this.root = rootElement;\n  }\n\n  register(application) {\n    const child = document.createElement('li');\n    this.applications.push(application);\n    child.addEventListener('click', this.initApplication.bind(this, application, this.publicSandbox));\n    child.innerHTML = application.prototype.title;\n    this.element.appendChild(child);\n  }\n\n  registerCoreApplication(application) {\n    const child = document.createElement('li');\n    this.applications.push(application);\n    child.addEventListener('click', this.initApplication.bind(this, application, this.sandbox));\n    child.innerHTML = application.prototype.title;\n    this.element.appendChild(child);\n  }\n\n  initApplication(application) {\n    const applicationInstance = new application(this.sandbox);\n    applicationInstance.load(this.root);\n    this.sandbox.notify('application:init', applicationInstance);\n    this.instances.push(applicationInstance);\n  }\n\n}\n"]}